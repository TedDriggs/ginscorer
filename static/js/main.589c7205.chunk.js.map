{"version":3,"sources":["models/outcome.ts","models/index.ts","State.ts","Effects.ts","components/AppHeader/AppHeader.tsx","components/util/Event.ts","components/Button/index.tsx","Actions.ts","components/util/Ref.ts","components/Drawer/Drawer.tsx","components/Drawer/Toggle.tsx","components/Form.tsx","ControlledInput.ts","components/Input/Base.tsx","components/Input/Input.tsx","components/Input/Number.tsx","components/PlayersInput/PlayersInput.tsx","components/PlayersForm.tsx","Reducer.ts","containers/CommandBar/index.tsx","models/stats.ts","components/Radio/Radio.tsx","components/RadioGroup/RadioGroup.tsx","components/GameInput/GameInput.tsx","components/ScoreColumn/ScoreColumn.tsx","components/ScrollViewer/index.tsx","components/SetView/Summary.tsx","components/SetView/SetView.tsx","components/StatsViewer/StatsViewer.tsx","components/MatchViewer/MatchResultViewer.tsx","components/MatchViewer/MatchViewer.tsx","containers/CurrentMatchViewer.ts","layouts/playing/Playing.tsx","App.tsx","registerServiceWorker.ts","index.tsx"],"names":["reduceGames","games","frame1","frame1End","reduceSet","frame2","frame2End","frame3","isSetFinished","ginSet","Boolean","finalResult","offset","endIndices","wins","[object Object]","Player","One","Two","scores","setGames","bonuses","reverse","nextEnd","pop","index","game","entries","Math","max","length","winner","points","runningTotal","push","Object","assign","player","label","PLAYERS","forEach","filter","wonBy","reduce","bonus","g","ginBonus","gin","b","getWinner","abs","currentScores","undefined","Gin","None","Normal","Super","computeMatchResult","sets","v","isHollywood","every","otherPlayer","nameOfPlayer","players","player1Name","player2Name","Game","x","State","state","version","migrateV1ToV2","UnknownVersionError","MigrationError","Error","message","super","this","INITIAL_STATE","initialDealer","persistState","window","localStorage","setItem","JSON","stringify","Promise","resolve","AppHeader_AppHeader","jsx_runtime","className","children","consumeEvent","e","stopPropagation","preventDefault","Button_Button","react","_a","ref","primary","props","__rest","classnames_default","onClick","button","confirmation","confirm","creators","UndoGame","type","RenamePlayers","names","FinishGame","result","StartNewMatch","SetInitialDealer","dealer","focusRef","current","focus","refChildHasFocus","_b","contains","document","activeElement","Drawer_Drawer","drawerElement","titleButton","navigator","standalone","bottom","getBoundingClientRect","bottomFix","innerHeight","style","setProperty","react_dom","CSSTransition","in","open","timeout","classNames","appear","mountOnEnter","unmountOnExit","onDismiss","call","onExit","onEntered","c-drawer--has-title","title","hideTitle","onKeyDown","key","dist","Escape","role","onTitleClick","Transition","body","DrawerTitleSpacer","ToggleDrawer","activator","setOpen","openDrawer","Form","onSubmit","disableSubmit","submitLabel","disabled","makeFieldChangeHandler","c","newVal","fieldName","value","onChange","name","BaseInput","Input_Input","Input_rest","target","NumberInput","rest","Number_rest","toString","evt","parseInputToInt","text","Number","parseInt","PlayersInput_PlayersInput_PlayersInput","handleChange","focusTarget","required","maxLength","PlayersForm","isRenaming","setRenaming","setValue","input","stopRenaming","marginLeft","marginRight","maxWidth","display","flexDirection","defaultValue","height","playerNameSelector","canUndoSelector","dealerSelector","matchHasStartedSelector","persisted","redux_loop_es","run","args","mapDispatchToProps","onStartNewMatch","onRenamePlayers","onUndoGame","CommandBar","es","playerNames","canUndo","hasMatchStarted","newPerPlayer","reduceGamesToWins","reduceGamesToMeanPoints","perPlayer","reduceGamesToMaxStreak","currentStreak","maxStreak","reduceGamesToBiggestWin","reduceGamesToGins","Radio_Radio_Radio","root","hasFocus","handleFocusChange","forceUpdate","Radio_rest","c-radio--checked","selected","c-radio--disabled","c-radio--nonative","hideNative","c-radio--has-focus","checked","onFocus","onBlur","RadioGroup_RadioGroup_RadioGroup","react_default","a","Component","first","createRef","RadioGroup_rest","c-radio-group--horizontal","horizontal","c-radio-group--hide-native","choices","map","choice","idx","PartialGame","DEFAULT","GameInput_GameInput_GameInput","GameInput_rest","min","ScoreColumn_ScoreColumn","ScoreColumn_rest","ScoreRow","BonusRow","isFirst","winnerCell","data-gin","loserCell","bonusCell","c-bonusrow--first","ScrollViewer_ScrollViewer","overflowX","overflowY","SetSummary","outerProps","Summary_rest","SetSummaryContainer","finished","c-set-summary--clickable","SetView_SetView_SetView","StatsViewer_StatsViewer","layout","showDealer","StatsStack","StatsGrid","renderStats","formatter","StackRow","formatNumber","toFixed","formatGinCount","normals","supers","normal","whiteSpace","superSpan","opacity","DealerToken","StatsGridRow","row","lodash","meanWinSize","biggestWin","ginGames","dispatch","Arrow","direction","viewBox","width","d","fill","transform","MatchResultViewer_MatchResultViewer","onNewMatch","GameForm","draft","setDraft","onSubmitGame","matchSelector","lib","CurrentMatchViewer_mapDispatchToProps","CurrentMatchViewer","readOnly","MatchViewer_rest","gameFormRef","stats","reduceGamesToStats","drawerOpen","setDrawerOpen","closeGameForm","gameForm","c-match-viewer--finished","react_responsive_default","minWidth","s","i","Playing_Playing","store","redux","__REDUX_DEVTOOLS_EXTENSION__","action","slice","raw","getItem","parsed","parse","isState","console","error","retrieveState","src_App_0","isLocalhost","location","hostname","match","registerValidSW","swUrl","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","catch","getElementById","URL","origin","addEventListener","fetch","response","status","headers","get","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.589c7205.chunk.js","sourcesContent":["import { Game, Gin, otherPlayer, Player, PLAYERS } from '.';\n\n// Output models for showing the result of a match.\n\n/**\n * A bonus awarded to a player at the end of a set. For example,\n * the first player to exceed 100 game points receives a 100-point\n * bonus for \"going over\".\n */\nexport interface Bonus {\n    player: Player;\n    points: number;\n    label: string;\n}\n\nexport interface GameInSet extends Game {\n    runningTotal: number;\n}\n\nexport type GinSet = GinSetInProgress | GinSetFinal;\n\nexport interface GinSetInProgress {\n    games: GameInSet[];\n    currentScores: {\n        [Player.One]: number;\n        [Player.Two]: number;\n    };\n    bonuses: Bonus[];\n    finalResult?: never;\n}\n\nexport interface GinSetFinal {\n    games: GameInSet[];\n    currentScores?: never;\n    bonuses: Bonus[];\n    finalResult: GinSetResult;\n}\n\nexport interface GinSetResult {\n    winner: Player;\n    /**\n     * The total number of points the player earned for the set.\n     */\n    points: number;\n}\n\nexport interface GinMatch {\n    games: Game[];\n    sets: GinSet[];\n    finalResult?: GinMatchResult;\n}\n\nexport interface GinMatchResult {\n    /**\n     * Whether the winning player won every single match. In this case,\n     * the `points` property will be 2x the sum of the three sets.\n     */\n    isHollywood: boolean;\n    winner: Player;\n    points: number;\n}\n\nexport const reduceGamesToMatch = (games: Game[]): GinMatch => {\n    const sets = reduceGames(games);\n    const finalResult = sets.every(isSetFinished)\n        ? computeMatchResult(sets, games)\n        : undefined;\n\n    return {\n        games,\n        sets,\n        finalResult,\n    };\n};\n\n/**\n * Reduce a sequence of games into three sets.\n *\n * @param games A sequence of games in order played\n */\nexport const reduceGames = (games: Game[]): [GinSet, GinSet, GinSet] => {\n    const [frame1, frame1End] = reduceSet(games);\n    const [frame2, frame2End] = reduceSet(games, 1, [frame1End]);\n    const [frame3] = reduceSet(games, 2, [frame1End, frame2End]);\n\n    return [frame1, frame2, frame3];\n};\n\n/**\n * Checks if a set is finished. This function assumes that sets are built by\n * `reduceSet` and therefore will always have bonuses applied as soon as a\n * player \"goes out\".\n */\nexport const isSetFinished = (ginSet: GinSet): ginSet is GinSetFinal =>\n    Boolean(ginSet.finalResult);\n\nexport const isSetInProgress = (ginSet: GinSet): ginSet is GinSetInProgress =>\n    Boolean(ginSet.currentScores);\n\n/**\n * Transform a sequence of games into a set.\n * @param games A raw sequence of games\n * @param offset The 0-indexed frame number. In gin, a player's first win\n * is not propagated to frames 2 or 3.\n * @param endIndices The index of the last game from the previous set.\n *\n * @return An array containing a gin set, and - if the set is finished - the\n * index of the last game processed.\n */\nconst reduceSet = (\n    games: Game[],\n    offset: number = 0,\n    endIndices: (number | undefined)[] = [],\n): [GinSet, number?] => {\n    /**\n     * Map of player ID to win count, adjusted for the frame entry requirement.\n     * This is used for applying bonuses for win count at the end of the frame,\n     * in addition to gating game entry into the frame.\n     */\n    const wins = {\n        [Player.One]: offset * -1,\n        [Player.Two]: offset * -1,\n    };\n\n    const scores = {\n        [Player.One]: 0,\n        [Player.Two]: 0,\n    };\n\n    const setGames: GameInSet[] = [];\n    const bonuses: Bonus[] = [];\n\n    endIndices.reverse();\n    let nextEnd = endIndices.pop();\n\n    for (const [index, game] of games.entries()) {\n        // If we've passed the end of a previous set, then we reduce the barrier\n        // to entry for the current set by 1 if the player is winless.\n        if (typeof nextEnd === 'number' && index >= nextEnd + 1) {\n            wins[Player.One] = Math.max(\n                -1 * endIndices.length,\n                wins[Player.One],\n            );\n            wins[Player.Two] = Math.max(\n                -1 * endIndices.length,\n                wins[Player.Two],\n            );\n            nextEnd = endIndices.pop();\n        }\n\n        // Increment win counter to maybe qualify for frame and to\n        // ensure the player gets credit for the win in bonus calculation.\n        wins[game.winner] += 1;\n\n        // For frame 2 and frame 3, skip games that don't qualify\n        if (wins[game.winner] <= 0) continue;\n\n        scores[game.winner] += game.points;\n        const runningTotal = scores[game.winner];\n\n        setGames.push({\n            ...game,\n            runningTotal,\n        });\n\n        if (runningTotal >= 100) {\n            bonuses.push({\n                player: game.winner,\n                points: 100,\n                label: 'Going out',\n            });\n\n            PLAYERS.forEach(player => {\n                if (wins[player] > 0) {\n                    bonuses.push({\n                        player,\n                        points: 10 * wins[player],\n                        label: 'Wins',\n                    });\n                }\n            });\n\n            PLAYERS.forEach(player => {\n                const points = setGames\n                    .filter(wonBy(player))\n                    .reduce((bonus, g) => bonus + ginBonus(g.gin), 0);\n\n                if (points) {\n                    bonuses.push({\n                        player,\n                        points,\n                        label: 'Gins',\n                    });\n                }\n            });\n\n            if (wins[Player.Two] <= 0) {\n                bonuses.push({\n                    player: Player.One,\n                    points:\n                        runningTotal +\n                        bonuses\n                            .filter(g => g.player === Player.One)\n                            .reduce((b, { points }) => b + points, 0),\n                    label: 'Blitz',\n                });\n            }\n\n            if (wins[Player.One] <= 0) {\n                bonuses.push({\n                    player: Player.Two,\n                    points:\n                        runningTotal +\n                        bonuses\n                            .filter(g => g.player === Player.Two)\n                            .reduce((b, { points }) => b + points, 0),\n                    label: 'Blitz',\n                });\n            }\n\n            scores[Player.One] += bonuses\n                .filter(g => g.player === Player.One)\n                .reduce((b, { points }) => b + points, 0);\n\n            scores[Player.Two] += bonuses\n                .filter(g => g.player === Player.Two)\n                .reduce((b, { points }) => b + points, 0);\n\n            const finalResult = {\n                winner: getWinner(scores),\n                points: Math.abs(scores[Player.One] - scores[Player.Two]),\n            };\n\n            // We don't include running totals if the game has ended\n            return [{ bonuses, finalResult, games: setGames }, index];\n        }\n    }\n\n    return [\n        {\n            bonuses,\n            currentScores: scores,\n            games: setGames,\n        },\n        // The game didn't end, so no end marker is returned.\n        undefined,\n    ];\n};\n\nconst getWinner = (scores: {\n    [Player.One]: number;\n    [Player.Two]: number;\n}): Player =>\n    scores[Player.One] > scores[Player.Two] ? Player.One : Player.Two;\n\nconst ginBonus = (gin: Gin): number => {\n    switch (gin) {\n        case Gin.None:\n            return 0;\n        case Gin.Normal:\n            return 25;\n        case Gin.Super:\n            return 50;\n    }\n};\n\nconst wonBy =\n    (player: Player) =>\n    (game: Game): boolean =>\n        game.winner === player;\n\nconst computeMatchResult = (sets: GinSet[], games: Game[]): GinMatchResult => {\n    const scores = {\n        [Player.One]: 0,\n        [Player.Two]: 0,\n    };\n\n    sets.forEach(v => (scores[v.finalResult!.winner] += v.finalResult!.points));\n\n    const winner = getWinner(scores);\n    const isHollywood = games.every(wonBy(winner));\n    return {\n        winner,\n        isHollywood,\n        points: isHollywood\n            ? 2 * scores[winner]\n            : scores[winner] - scores[otherPlayer(winner)],\n    };\n};\n","export * from './outcome';\n\nexport enum Player {\n    One = 1,\n    Two = 2,\n}\n\nexport const PLAYERS = [Player.One, Player.Two];\n\nexport interface PlayerNames {\n    player1Name: string;\n    player2Name: string;\n}\n\n/**\n * Get the name of a player from a pair of names.\n */\nexport const nameOfPlayer = (players: PlayerNames, player: Player): string =>\n    player === Player.One ? players.player1Name : players.player2Name;\n\n/**\n * Get the opponent of the passed-in player.\n */\nexport const otherPlayer = (player: Player): Player =>\n    player === Player.One ? Player.Two : Player.One;\n\nexport enum Gin {\n    None = 'none',\n    Normal = 'normal',\n    Super = 'super',\n}\n\n/**\n * A single game of gin; undercuts are not tracked separately.\n */\nexport interface Game {\n    winner: Player;\n    points: number;\n    gin: Gin;\n}\n\nexport const Game = {\n    guard: (x: any): x is Game =>\n        x.winner !== null &&\n        typeof x === 'object' &&\n        typeof x.points === 'number' &&\n        typeof x.gin === 'string' &&\n        x.winner !== undefined,\n};\n","import { Game, Player, PLAYERS } from './models';\n\nexport const LATEST_STATE_VERSION = 2 as const;\n\nexport interface StateV1 {\n    version: 1;\n    player1Name: string;\n    player2Name: string;\n    games: Game[];\n}\n\nexport const StateV1 = {\n    guard: (x: any): x is StateV1 =>\n        typeof x === 'object' &&\n        typeof x.player1Name === 'string' &&\n        typeof x.player2Name === 'string' &&\n        x.version === 1 &&\n        Array.isArray(x.games),\n};\n\nexport interface StateV2 {\n    version: 2;\n    player1Name: string;\n    player2Name: string;\n    games: Game[];\n    initialDealer: Player;\n}\n\nexport const StateV2 = {\n    guard: (x: any): x is StateV2 =>\n        typeof x === 'object' &&\n        typeof x.player1Name === 'string' &&\n        typeof x.player2Name === 'string' &&\n        x.version === 1 &&\n        Array.isArray(x.games) &&\n        PLAYERS.includes(x.initialDealer),\n};\n\nexport type HistoricalState = StateV1 | StateV2;\n\nexport type State = StateV2;\n\nexport const State = {\n    /**\n     * Migrate a state object forward to the latest version expected by\n     * the app.\n     *\n     * @param state A valid state emitted by an earlier version of the app\n     * @returns A state object on the current version\n     */\n    modernize: (state: HistoricalState): State => {\n        switch (state.version) {\n            case 2:\n                return state;\n            case 1:\n                return migrateV1ToV2(state);\n            default:\n                throw new UnknownVersionError(state);\n        }\n    },\n};\n\nclass MigrationError extends Error {\n    constructor(message: string, public readonly state: unknown) {\n        super(message);\n    }\n}\n\nclass UnknownVersionError extends MigrationError {\n    public readonly version: unknown;\n    constructor(state: HistoricalState) {\n        super(`Unknown state version '${state.version}'`, state);\n        this.version = state.version;\n    }\n}\n\nexport const INITIAL_STATE: State = {\n    version: LATEST_STATE_VERSION,\n    player1Name: 'Player 1',\n    player2Name: 'Player 2',\n    games: [],\n    initialDealer: Player.One,\n};\n\nexport const isState = (x: any): x is State =>\n    typeof x === 'object' &&\n    typeof x.player1Name === 'string' &&\n    typeof x.player2Name === 'string' &&\n    typeof x.version === 'number';\n\nconst migrateV1ToV2 = (state: StateV1): StateV2 => ({\n    ...state,\n    version: 2,\n    initialDealer: Player.One,\n});\n","import { isState, State } from './State';\n\nconst LOCAL_STORAGE_KEY = 'reduxState';\n\n/**\n * Write the current redux state into local storage.\n */\nexport const persistState = (state: State): Promise<void> => {\n    window.localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(state));\n    return Promise.resolve();\n};\n\n/**\n * Read the redux state from local storage.\n */\nexport const retrieveState = (): State | undefined => {\n    const raw = window.localStorage.getItem(LOCAL_STORAGE_KEY);\n    if (!raw) return;\n\n    try {\n        const parsed = JSON.parse(raw);\n        if (!isState(parsed)) return;\n        try {\n            return State.modernize(parsed);\n        } catch (e) {\n            console.error(e);\n            return;\n        }\n    } catch (e) {\n        console.error('Could not read state as JSON', e);\n        return;\n    }\n};\n","import { FC } from 'react';\n\nimport './AppHeader.css';\n\nexport const AppHeader: FC = () => (\n    <header className=\"c-app-header\">\n        <h1>Gin Scorer</h1>\n    </header>\n);\n","export interface ConsumableEvent {\n    preventDefault(): void;\n    stopPropagation(): void;\n}\n\nexport const consumeEvent = (e: ConsumableEvent) => {\n    e.stopPropagation();\n    e.preventDefault();\n};\n","import classNames from 'classnames';\nimport { ButtonHTMLAttributes, forwardRef } from 'react';\n\nimport { consumeEvent } from '../util/Event';\n\nimport './Button.scss';\n\nexport type ButtonRef = Pick<\n    HTMLButtonElement,\n    'getBoundingClientRect' | 'focus'\n>;\n\nexport const Button = forwardRef<\n    ButtonRef,\n    Omit<ButtonHTMLAttributes<HTMLButtonElement>, 'onClick'> & {\n        primary?: boolean;\n        /**\n         * When set to a non-empty string, a confirmation message to show to\n         * the user. If they click the button and confirm at the prompt,\n         * the button's `onClick` function will be called.\n         */\n        confirmation?: string;\n        onClick?(): void;\n    }\n>(({ primary, ...props }, ref) => (\n    <button\n        {...props}\n        ref={ref as any}\n        className={classNames(\n            'c-button',\n            primary && 'c-button--primary',\n            props.className,\n        )}\n        onClick={e => {\n            if (e.button || !props.onClick) return;\n            consumeEvent(e);\n            if (props.confirmation && !window.confirm(props.confirmation)) {\n                return;\n            }\n            props.onClick();\n        }}\n    />\n));\n","import { Game, Player, PlayerNames } from './models';\n\n/**\n * Action emitted when a game has been finished and a new result is ready.\n * The provided game will be added to the end of the game list.\n */\nexport interface FinishGame {\n    type: 'FinishGame';\n    result: Game;\n}\n\n/**\n * Remove the most recent game from the history; useful for correcting\n * mistakes in submission.\n */\nexport interface UndoGame {\n    type: 'UndoGame';\n}\n\n/**\n * Start a new match, clearing all game history.\n */\nexport interface StartNewMatch {\n    type: 'StartNewMatch';\n}\n\nexport interface RenamePlayers extends PlayerNames {\n    type: 'RenamePlayers';\n}\n\nexport interface SetInitialDealer {\n    type: 'SetInitialDealer';\n    dealer: Player;\n}\n\nexport type Action =\n    | RenamePlayers\n    | FinishGame\n    | StartNewMatch\n    | UndoGame\n    | SetInitialDealer;\n\nexport const creators = {\n    UndoGame: (): UndoGame => ({\n        type: 'UndoGame',\n    }),\n    RenamePlayers: (names: PlayerNames): RenamePlayers => ({\n        ...names,\n        type: 'RenamePlayers',\n    }),\n    FinishGame: (result: Game): FinishGame => ({\n        type: 'FinishGame',\n        result,\n    }),\n    StartNewMatch: (): StartNewMatch => ({\n        type: 'StartNewMatch',\n    }),\n    SetInitialDealer: (dealer: Player): SetInitialDealer => ({\n        type: 'SetInitialDealer',\n        dealer,\n    }),\n};\n","import { RefObject } from 'react';\n\nexport const focusRef = (ref: RefObject<{ focus(): void }>): void => {\n    ref.current?.focus();\n};\n\nexport const refChildHasFocus = (ref: RefObject<HTMLElement>) => (): boolean =>\n    ref.current?.contains(document.activeElement) ?? false;\n\nexport const mapRef = <T, U>(ref: RefObject<T>, mapFn: (r: T) => U): U | null =>\n    ref.current ? mapFn(ref.current) : null;\n","import classNames from 'classnames';\nimport { FC, KeyboardEvent, useLayoutEffect, useRef } from 'react';\nimport { createPortal } from 'react-dom';\nimport { CSSTransition, Transition } from 'react-transition-group';\nimport { Key } from 'w3c-keys';\n\nimport { Button, ButtonRef } from '../Button';\nimport { consumeEvent } from '../util/Event';\nimport { focusRef } from '../util/Ref';\nimport './Drawer.css';\n\nconst TRANSITION_TIMEOUT_MS = 125;\n\nexport const Drawer: FC<{\n    open?: boolean;\n    hideTitle?: boolean;\n    title?: string;\n    onTitleClick?(): void;\n    onEntered?(): void;\n    /**\n     * Event handler called when the user attempts to dismiss the\n     * drawer. If no handler is provided, the user cannot dismiss\n     * the drawer.\n     */\n    onDismiss?(): void;\n}> = props => {\n    const drawerElement = useRef<HTMLDivElement>(null);\n    const titleButton = useRef<ButtonRef>(null);\n    const handleKeyDown = (e: KeyboardEvent<unknown>): void => {\n        if (e.key === Key.Escape && props.onDismiss) {\n            consumeEvent(e);\n            props.onDismiss();\n        }\n    };\n\n    // Safari's address bar interacts frustratingly with the 100vh measurement\n    // used to anchor the drawer to the bottom of the screen. To avoid drawer\n    // buttons being drawn inaccessibly out of view, push the button in the\n    // closed state up by the amount it's out of frame.\n    useLayoutEffect(() => {\n        if (!titleButton.current) return;\n        // There's no address bar in standalone mode\n        if ('standalone' in navigator && (navigator as any).standalone) return;\n        const { bottom } = titleButton.current.getBoundingClientRect();\n        const bottomFix = Math.max(0, bottom - window.innerHeight);\n        drawerElement.current?.style.setProperty(\n            '--safari-correction',\n            `${bottomFix}px`,\n        );\n    }, [window.innerHeight]);\n\n    return createPortal(\n        <>\n            <CSSTransition\n                in={props.open}\n                timeout={TRANSITION_TIMEOUT_MS}\n                classNames=\"c-drawer__backdrop\"\n                appear\n                mountOnEnter\n                unmountOnExit\n            >\n                <div\n                    onClick={e => {\n                        // only consider primary clicks\n                        if (e.button !== 0) return;\n                        props.onDismiss?.();\n                    }}\n                    className=\"c-drawer__backdrop\"\n                />\n            </CSSTransition>\n            <CSSTransition\n                in={props.open}\n                classNames=\"c-drawer\"\n                timeout={TRANSITION_TIMEOUT_MS}\n                onExit={() => focusRef(titleButton)}\n                onEntered={props.onEntered}\n                appear\n            >\n                <div\n                    ref={drawerElement}\n                    className={classNames('c-drawer', {\n                        'c-drawer--has-title':\n                            Boolean(props.title) && !props.hideTitle,\n                    })}\n                    onKeyDown={handleKeyDown}\n                    role=\"dialog\"\n                >\n                    {props.title && (\n                        <Button\n                            ref={titleButton}\n                            className=\"c-drawer__title\"\n                            onClick={props.onTitleClick}\n                        >\n                            <span className=\"c-drawer__title__text\">\n                                {props.title}\n                            </span>\n                        </Button>\n                    )}\n                    <Transition\n                        in={props.open}\n                        timeout={TRANSITION_TIMEOUT_MS}\n                        appear\n                        mountOnEnter\n                        unmountOnExit\n                    >\n                        {props.children}\n                    </Transition>\n                </div>\n            </CSSTransition>\n        </>,\n        document.body,\n    );\n};\n\n/**\n * Placeholder element which can be used to make sure scrolling content isn't\n * hidden by the drawer title.\n */\nexport const DrawerTitleSpacer: FC = () => (\n    <div className=\"c-drawer-title-placeholder\" />\n);\n","import { FC, ReactNode, useState } from 'react';\nimport { Drawer } from '.';\n\nexport const ToggleDrawer: FC<{\n    activator(props: { openDrawer(): void }): ReactNode;\n}> = ({ activator, children }) => {\n    const [open, setOpen] = useState(false);\n    return (\n        <>\n            {activator({ openDrawer: () => setOpen(true) })}\n            <Drawer open={open} onDismiss={() => setOpen(false)}>\n                {children}\n            </Drawer>\n        </>\n    );\n};\n","import { FC } from 'react';\n\nimport { Button } from './Button';\nimport { consumeEvent } from './util/Event';\n\n/**\n * A wrapper for a native form that provides Enter-key submission abilities\n * and semantic correctness.\n */\nexport const Form: FC<{\n    className?: string;\n    style?: React.CSSProperties;\n    disableSubmit?: boolean;\n    submitLabel?: React.ReactNode;\n    onSubmit(): void;\n}> = props => (\n    <form\n        style={props.style}\n        className={props.className}\n        onSubmit={e => {\n            consumeEvent(e);\n            if (props.disableSubmit) return;\n            props.onSubmit();\n        }}\n    >\n        {props.children}\n        {props.submitLabel && (\n            <Button primary disabled={props.disableSubmit} type=\"submit\">\n                {props.submitLabel}\n            </Button>\n        )}\n    </form>\n);\n","import { Component } from 'react';\n\nexport type ChangeHandler<T> = (newVal: T, name?: string) => void;\n\nexport interface ControlledInput<T> {\n    value: T;\n    disabled?: boolean;\n    name?: string;\n    onChange: ChangeHandler<T>;\n}\n\nexport const makeFieldChangeHandler =\n    <T extends {}>(c: Component<ControlledInput<T>>) =>\n    (newVal: T[keyof T], fieldName: keyof T): void => {\n        const { value, onChange, disabled, name } = c.props;\n\n        if (disabled) return;\n\n        if (onChange) {\n            onChange(\n                {\n                    ...(value as any),\n                    [fieldName]: newVal,\n                },\n                name,\n            );\n        }\n    };\n","import classNames from 'classnames';\nimport { forwardRef, InputHTMLAttributes } from 'react';\n\nimport './Input.css';\n\nexport const BaseInput = forwardRef<\n    HTMLInputElement,\n    InputHTMLAttributes<HTMLInputElement>\n>((props, ref) => (\n    <input\n        ref={ref}\n        {...props}\n        className={classNames('c-base-input', props.className)}\n    />\n));\n","import classNames from 'classnames';\nimport { forwardRef, InputHTMLAttributes } from 'react';\n\nimport { ControlledInput } from '../../ControlledInput';\nimport { Focus } from '../util/Focus';\nimport { BaseInput } from './Base';\nimport './Input.css';\n\nexport const Input = forwardRef<\n    Focus,\n    ControlledInput<string> & {\n        className?: string;\n        label?: string;\n    } & Pick<InputHTMLAttributes<HTMLInputElement>, 'required' | 'maxLength'>\n>(({ onChange, label, className, ...props }, ref) => (\n    <label className={classNames('c-input', className)}>\n        {label && <div className=\"c-input-label\">{label}</div>}\n        <BaseInput\n            {...props}\n            ref={ref as any}\n            onChange={e => onChange(e.target.value, props.name)}\n        />\n    </label>\n));\n","import classNames from 'classnames';\nimport { FC } from 'react';\n\nimport { ControlledInput } from '../../ControlledInput';\nimport { BaseInput } from './Base';\n\nexport interface NumberInputProps extends ControlledInput<number | null> {\n    min?: number;\n    max?: number;\n    step?: number;\n    className?: string;\n}\n\nexport const NumberInput: FC<NumberInputProps> = props => {\n    const { value, className, ...rest } = props;\n    return (\n        <BaseInput\n            {...rest}\n            className={classNames('c-number-input', className)}\n            type=\"number\"\n            value={value !== null ? value.toString() : ''}\n            onChange={evt => {\n                props.onChange(parseInputToInt(evt.target.value), props.name);\n            }}\n        />\n    );\n};\n\nconst parseInputToInt = (text: string): number | null =>\n    text === '' ? null : Number.parseInt(text, 10);\n","import { Component, createRef, ReactNode } from 'react';\n\nimport { ControlledInput, makeFieldChangeHandler } from '../../ControlledInput';\nimport { PlayerNames } from '../../models';\nimport { Input } from '../Input';\nimport { Focus } from '../util/Focus';\nimport { focusRef } from '../util/Ref';\nimport './PlayersInput.css';\n\nexport class PlayersInput extends Component<ControlledInput<PlayerNames>> {\n    private readonly handleChange = makeFieldChangeHandler(this);\n    private readonly focusTarget = createRef<Focus>();\n\n    public render(): ReactNode {\n        const { value, disabled } = this.props;\n        return (\n            <div className=\"c-players-input\">\n                <Input\n                    ref={this.focusTarget}\n                    label=\"Player 1\"\n                    name=\"player1Name\"\n                    value={value.player1Name}\n                    disabled={disabled}\n                    onChange={this.handleChange}\n                    required\n                    maxLength={15}\n                />\n                <Input\n                    label=\"Player 2\"\n                    name=\"player2Name\"\n                    value={value.player2Name}\n                    disabled={disabled}\n                    onChange={this.handleChange}\n                    required\n                    maxLength={15}\n                />\n            </div>\n        );\n    }\n\n    public readonly focus = () => focusRef(this.focusTarget);\n}\n","import { FC, useRef, useState } from 'react';\n\nimport { PlayerNames } from '../models';\nimport { Button, ButtonRef } from './Button';\nimport { Drawer } from './Drawer';\nimport { Form } from './Form';\nimport { PlayersInput } from './PlayersInput';\n\nexport interface PlayersFormProps {\n    value: PlayerNames;\n    onPlayersSubmit(players: PlayerNames): void;\n}\n\nexport const PlayersForm: FC<{\n    defaultValue: PlayerNames;\n    onSubmit(names: PlayerNames): void;\n}> = props => {\n    const [isRenaming, setRenaming] = useState(false);\n    const [value, setValue] = useState<PlayerNames | undefined>(undefined);\n    const button = useRef<ButtonRef>(null);\n    const input = useRef<PlayersInput>(null);\n\n    const stopRenaming = () => {\n        setRenaming(false);\n        setValue(undefined);\n        button.current?.focus();\n    };\n\n    return (\n        <>\n            <Button ref={button} onClick={() => setRenaming(true)}>\n                Rename Players\n            </Button>\n            <Drawer\n                title={isRenaming ? 'Rename Players' : undefined}\n                open={isRenaming}\n                onDismiss={stopRenaming}\n                onEntered={() => input.current?.focus()}\n            >\n                <Form\n                    style={{\n                        marginLeft: 10,\n                        marginRight: 10,\n                        maxWidth: '30em',\n                        display: 'flex',\n                        flexDirection: 'column',\n                    }}\n                    onSubmit={() => {\n                        if (!value) return;\n                        props.onSubmit(value);\n                        stopRenaming();\n                    }}\n                >\n                    <PlayersInput\n                        ref={input}\n                        value={value ?? props.defaultValue}\n                        onChange={v => setValue(v)}\n                    />\n                    <div style={{ height: 20 }} />\n                    <Button primary type=\"submit\">\n                        Update\n                    </Button>\n                </Form>\n            </Drawer>\n        </>\n    );\n};\n","import { Cmd, Loop, loop, LoopReducer } from 'redux-loop';\nimport { Action } from './Actions';\nimport { persistState } from './Effects';\nimport { Game, nameOfPlayer, otherPlayer, Player } from './models';\nimport { State } from './State';\n\nexport const gameSelector = (state: State): Game[] => state.games;\n\nexport const playerNameSelector = ({\n    player1Name,\n    player2Name,\n}: State): Pick<State, 'player1Name' | 'player2Name'> => ({\n    player1Name,\n    player2Name,\n});\n\nexport const canUndoSelector = ({ games }: State): boolean =>\n    Boolean(games.length);\n\nexport const dealerSelector = ({ games, initialDealer }: State): Player =>\n    games.length % 2 === 0 ? initialDealer : otherPlayer(initialDealer);\n\nexport const dealerNameSelector = (state: State): string =>\n    nameOfPlayer(state, dealerSelector(state));\n\nexport const matchHasStartedSelector = (state: State): boolean =>\n    Boolean(state.games.length);\n\nexport const reducer: LoopReducer<State, Action> = (\n    state: State,\n    action: Action,\n) => {\n    switch (action.type) {\n        case 'RenamePlayers': {\n            const { player1Name, player2Name } = action;\n            return persisted({\n                ...state,\n                player1Name,\n                player2Name,\n            });\n        }\n        case 'FinishGame': {\n            return persisted({\n                ...state,\n                games: [...state.games, action.result],\n            });\n        }\n        case 'UndoGame': {\n            return persisted({\n                ...state,\n                games: state.games.slice(0, state.games.length - 1),\n            });\n        }\n        case 'StartNewMatch': {\n            return persisted({\n                ...state,\n                games: [],\n            });\n        }\n        case 'SetInitialDealer': {\n            // If the match is in progress, don't allow the initial dealer to\n            // change.\n            if (state.games.length) return state;\n\n            return persisted({\n                ...state,\n                initialDealer: action.dealer,\n            });\n        }\n        default: {\n            return state;\n        }\n    }\n};\n\nconst persisted = (state: State): Loop<State> =>\n    loop(\n        state,\n        Cmd.run(persistState, {\n            args: [state],\n        }),\n    );\n","import { FC } from 'react';\n\nimport { connect } from 'react-redux';\nimport { Button } from 'src/components/Button';\nimport { PlayerNames } from 'src/models';\nimport { creators } from '../../Actions';\nimport { PlayersForm } from '../../components/PlayersForm';\nimport {\n    canUndoSelector,\n    matchHasStartedSelector,\n    playerNameSelector,\n} from '../../Reducer';\nimport { State } from '../../State';\n\ninterface StateProps {\n    playerNames: PlayerNames;\n    canUndo: boolean;\n    hasMatchStarted: boolean;\n}\n\ninterface DispatchProps {\n    onRenamePlayers: typeof creators.RenamePlayers;\n    onStartNewMatch(): void;\n    onUndoGame(): void;\n}\n\nconst mapStateToProps = (state: State): StateProps => ({\n    playerNames: playerNameSelector(state),\n    canUndo: canUndoSelector(state),\n    hasMatchStarted: matchHasStartedSelector(state),\n});\n\nconst mapDispatchToProps: DispatchProps = {\n    onStartNewMatch: creators.StartNewMatch,\n    onRenamePlayers: creators.RenamePlayers,\n    onUndoGame: creators.UndoGame,\n};\n\nconst DisconnectedCommandBar: FC<StateProps & DispatchProps> = props => (\n    <div className=\"c-command-bar\">\n        <Button onClick={props.onUndoGame} disabled={!props.canUndo}>\n            Undo Last Game\n        </Button>\n        <Button\n            onClick={props.onStartNewMatch}\n            disabled={!props.hasMatchStarted}\n            confirmation=\"Are you sure you want to start a new match?\"\n        >\n            New Match\n        </Button>\n        <PlayersForm\n            defaultValue={props.playerNames}\n            onSubmit={props.onRenamePlayers}\n        />\n    </div>\n);\n\nexport const CommandBar = connect(\n    mapStateToProps,\n    mapDispatchToProps,\n)(DisconnectedCommandBar);\n","import { Game, Gin, otherPlayer, Player } from '.';\n\nexport interface PerPlayer<T = number> {\n    [Player.One]: T;\n    [Player.Two]: T;\n}\n\nexport interface Stats {\n    /**\n     * The number of games won by each player in the current match.\n     */\n    wins: PerPlayer;\n    /**\n     * The maximum number of consecutive games won by each player in\n     * the current match.\n     */\n    maxStreak: PerPlayer;\n    /**\n     * The average number of points each player received on winning a\n     * game in the current match.\n     */\n    meanWinSize: PerPlayer;\n    /**\n     * The max number of points earned by each player in a single game.\n     */\n    biggestWin: PerPlayer;\n    /**\n     * The number of games in which a player earned normal and super gins.\n     * A gin in multiple columns will only count once in this stat.\n     */\n    ginGames: PerPlayer<{ [Gin.Normal]: number; [Gin.Super]: number }>;\n}\n\nconst newPerPlayer = (): PerPlayer => ({\n    [Player.One]: 0,\n    [Player.Two]: 0,\n});\n\nexport const reduceGamesToStats = (games: Game[]): Stats => {\n    const wins = reduceGamesToWins(games);\n\n    return {\n        wins,\n        meanWinSize: reduceGamesToMeanPoints(games, wins),\n        maxStreak: reduceGamesToMaxStreak(games),\n        biggestWin: reduceGamesToBiggestWin(games),\n        ginGames: reduceGamesToGins(games),\n    };\n};\n\nconst reduceGamesToWins = (games: Game[]): PerPlayer =>\n    games.reduce((state, game) => {\n        state[game.winner] += 1;\n        return state;\n    }, newPerPlayer());\n\nconst reduceGamesToMeanPoints = (games: Game[], wins: PerPlayer): PerPlayer => {\n    const perPlayer = games.reduce((state, game) => {\n        state[game.winner] += game.points;\n        return state;\n    }, newPerPlayer());\n    if (wins[Player.One]) perPlayer[Player.One] /= wins[Player.One];\n    if (wins[Player.Two]) perPlayer[Player.Two] /= wins[Player.Two];\n\n    return perPlayer;\n};\n\nconst reduceGamesToMaxStreak = (games: Game[]): PerPlayer => {\n    const currentStreak = newPerPlayer();\n    const maxStreak = newPerPlayer();\n\n    for (const game of games) {\n        currentStreak[game.winner] += 1;\n        currentStreak[otherPlayer(game.winner)] = 0;\n\n        if (currentStreak[game.winner] > maxStreak[game.winner]) {\n            maxStreak[game.winner] = currentStreak[game.winner];\n        }\n    }\n\n    return maxStreak;\n};\n\nconst reduceGamesToBiggestWin = (games: Game[]): PerPlayer =>\n    games.reduce((state, game) => {\n        state[game.winner] = Math.max(state[game.winner], game.points);\n        return state;\n    }, newPerPlayer());\n\nconst reduceGamesToGins = (\n    games: Game[],\n): PerPlayer<{ [Gin.Normal]: number; [Gin.Super]: number }> =>\n    games.reduce(\n        (state, game) => {\n            if (game.gin !== Gin.None) {\n                state[game.winner][game.gin] += 1;\n            }\n\n            return state;\n        },\n        {\n            [Player.One]: { [Gin.Normal]: 0, [Gin.Super]: 0 },\n            [Player.Two]: { [Gin.Normal]: 0, [Gin.Super]: 0 },\n        },\n    );\n","import classNames from 'classnames';\nimport { Component, createRef, ReactNode } from 'react';\n\nimport { focusRef, refChildHasFocus } from '../util/Ref';\nimport './Radio.css';\n\nexport interface RadioProps<T extends string | number = string> {\n    className?: string;\n    label?: string;\n    selected: boolean;\n    value: T;\n    disabled?: boolean;\n    name?: string;\n    /**\n     * When `true`, the native radio element will be rendered as 0x0 to avoid\n     * showing. The caller should then use classes to style the component as-desired.\n     */\n    hideNative?: boolean;\n    onChange(newValue: T, name?: string): void;\n}\n\nexport class Radio<T extends string | number = string> extends Component<\n    RadioProps<T>\n> {\n    private readonly root = createRef<HTMLLabelElement>();\n\n    // tslint:disable-next-line:member-ordering\n    public readonly hasFocus = refChildHasFocus(this.root);\n\n    public render(): ReactNode {\n        const { className, children, value, label, ...props } = this.props;\n\n        return (\n            <label\n                ref={this.root}\n                className={classNames('c-radio', className, {\n                    'c-radio--checked': props.selected,\n                    'c-radio--disabled': props.disabled,\n                    'c-radio--nonative': props.hideNative,\n                    'c-radio--has-focus': this.hasFocus(),\n                })}\n            >\n                <input\n                    name={props.name}\n                    disabled={props.disabled}\n                    checked={props.selected}\n                    onChange={this.handleChange}\n                    value={value.toString()}\n                    type=\"radio\"\n                    onFocus={this.handleFocusChange}\n                    onBlur={this.handleFocusChange}\n                />\n                {label}\n            </label>\n        );\n    }\n\n    public readonly focus = () => focusRef(this.root);\n\n    private readonly handleFocusChange = () => this.forceUpdate();\n\n    private readonly handleChange = () => {\n        this.props.onChange?.(this.props.value, this.props.name);\n    };\n}\n","import classNames from 'classnames';\nimport React from 'react';\n\nimport { ControlledInput } from '../../ControlledInput';\nimport { Radio } from '../Radio';\nimport { focusRef } from '../util/Ref';\nimport './RadioGroup.css';\n\nexport interface Choice<T extends string | number = string> {\n    label: string;\n    value: T;\n}\n\nexport interface RadioGroupProps<T extends string | number = string>\n    extends ControlledInput<T> {\n    className?: string;\n    label?: string;\n    choices: Choice<T>[];\n    name: string;\n    hideNative?: boolean;\n    horizontal?: boolean;\n}\n\n/** A set of radio buttons */\nexport class RadioGroup<\n    T extends string | number = string,\n> extends React.Component<RadioGroupProps<T>> {\n    private readonly first = React.createRef<Radio<T>>();\n\n    public render(): React.ReactNode {\n        const { className, name, ...props } = this.props;\n        return (\n            <div\n                className={classNames('c-radio-group', className, {\n                    'c-radio-group--horizontal': props.horizontal,\n                    'c-radio-group--hide-native': props.hideNative,\n                })}\n            >\n                {props.label && (\n                    <span className=\"c-radio-group__label\">{props.label}</span>\n                )}\n                {props.choices.map((choice, idx) => (\n                    <Radio<T>\n                        {...choice}\n                        key={choice.value}\n                        ref={idx === 0 ? this.first : undefined}\n                        name={name}\n                        disabled={props.disabled}\n                        hideNative={props.hideNative}\n                        selected={props.value === choice.value}\n                        onChange={props.onChange}\n                    />\n                ))}\n            </div>\n        );\n    }\n\n    public focus = () => focusRef(this.first);\n}\n","import { Component, createRef, ReactNode } from 'react';\n\nimport { ControlledInput, makeFieldChangeHandler } from '../../ControlledInput';\nimport { Game, Gin, Player } from '../../models';\nimport { NumberInput } from '../Input';\nimport { RadioGroup } from '../RadioGroup';\nimport { focusRef } from '../util/Ref';\nimport './GameInput.css';\n\n/**\n * A variant of the `Game` interface optimized for input.\n */\nexport interface PartialGame {\n    winner: Game['winner'];\n    points: number | null;\n    gin: Game['gin'];\n}\n\nconst DEFAULT_PARTIAL_GAME: PartialGame = {\n    winner: Player.One,\n    points: null,\n    gin: Gin.None,\n};\n\nexport const PartialGame = {\n    DEFAULT: DEFAULT_PARTIAL_GAME,\n};\n\nexport interface GameInputProps extends ControlledInput<PartialGame> {\n    player1Name: string;\n    player2Name: string;\n}\n\nexport class GameInput extends Component<GameInputProps> {\n    private readonly focusTarget = createRef<RadioGroup<Player>>();\n    private readonly handleChange = makeFieldChangeHandler(this);\n\n    public render(): ReactNode {\n        const { value, disabled, ...props } = this.props;\n\n        return (\n            <div className=\"c-game-input\">\n                <RadioGroup<Player>\n                    name=\"winner\"\n                    className=\"c-game-input__players\"\n                    choices={[\n                        { value: Player.One, label: props.player1Name },\n                        { value: Player.Two, label: props.player2Name },\n                    ]}\n                    value={value.winner}\n                    disabled={disabled}\n                    label=\"Winner\"\n                    onChange={this.handleChange}\n                    hideNative\n                    horizontal\n                    ref={this.focusTarget}\n                />\n                <div className=\"c-game-input__points\">\n                    <NumberInput\n                        name=\"points\"\n                        value={value.points}\n                        min={1}\n                        disabled={disabled}\n                        onChange={this.handleChange}\n                    />\n                    &nbsp; points\n                </div>\n                <RadioGroup<Gin>\n                    name=\"gin\"\n                    value={value.gin}\n                    className=\"c-game-input__gin\"\n                    choices={[\n                        { value: Gin.None, label: 'No Gin' },\n                        { value: Gin.Normal, label: 'Gin' },\n                        { value: Gin.Super, label: 'Super Gin' },\n                    ]}\n                    disabled={disabled}\n                    onChange={this.handleChange}\n                    horizontal\n                    hideNative\n                />\n            </div>\n        );\n    }\n\n    public readonly focus = () => focusRef(this.focusTarget);\n}\n","import { FC } from 'react';\n\nimport classNames from 'classnames';\nimport { Bonus, GameInSet, Gin, GinSet, Player, PlayerNames } from 'src/models';\nimport './ScoreColumn.css';\n\nexport const ScoreColumn: FC<\n    PlayerNames & {\n        className?: string;\n        value: GinSet;\n    }\n> = ({ value, ...props }) => (\n    <div className={classNames('c-scorecolumn', props.className)}>\n        <div className=\"c-scorecolumn__header\">\n            <div className=\"c-scorecolumn__player\">{props.player1Name}</div>\n            <div className=\"c-scorecolumn__player\">{props.player2Name}</div>\n        </div>\n        {value.games.map((game, index) => (\n            <ScoreRow {...game} key={`game-${index}`} />\n        ))}\n        {value.bonuses.map((bonus, index) => (\n            <BonusRow key={`bonus-${index}`} {...bonus} isFirst={index === 0} />\n        ))}\n    </div>\n);\n\nconst ScoreRow: FC<GameInSet> = ({ winner, gin, runningTotal }) => {\n    const winnerCell = (\n        <div className=\"c-scorerow__winner\" data-gin={gin} key=\"winner\">\n            {runningTotal}\n            {gin !== Gin.None && (\n                <span className=\"c-scorerow__winner__gin__star\">\n                    {' '}\n                    {gin === Gin.Normal && ''}\n                    {gin === Gin.Super && ''}\n                </span>\n            )}\n        </div>\n    );\n    const loserCell = <div className=\"c-scorerow__loser\" key=\"loser\" />;\n\n    return (\n        <div className=\"c-scorerow\">\n            {winner === Player.One\n                ? [winnerCell, loserCell]\n                : [loserCell, winnerCell]}\n        </div>\n    );\n};\n\nconst BonusRow: FC<Bonus & { isFirst?: boolean }> = props => {\n    const bonusCell = (\n        <div className=\"c-bonusrow__recipient\" key=\"winner\">\n            <span className=\"c-bonusrow__points\">{props.points}</span>\n            <span className=\"c-bonusrow__label\">{props.label}</span>\n        </div>\n    );\n\n    const loserCell = <div className=\"c-bonusrow__loser\" key=\"loser\" />;\n\n    return (\n        <div\n            className={classNames('c-bonusrow', {\n                'c-bonusrow--first': props.isFirst,\n            })}\n        >\n            {props.player === Player.One\n                ? [bonusCell, loserCell]\n                : [loserCell, bonusCell]}\n        </div>\n    );\n};\n","import classNames from 'classnames';\nimport { FC } from 'react';\n\nimport './ScrollViewer.css';\n\nexport const ScrollViewer: FC<{\n    className?: string;\n    overflowX?: 'hidden' | 'auto';\n    overflowY?: 'hidden' | 'auto';\n}> = ({\n    className,\n    children,\n    overflowX = 'auto' as 'auto',\n    overflowY = 'auto' as 'auto',\n}) => (\n    <div\n        className={classNames('c-scroll-viewer', className)}\n        style={{ overflowX, overflowY }}\n    >\n        {children}\n    </div>\n);\n","import { FC } from 'react';\n\nimport classNames from 'classnames';\nimport {\n    GinSet,\n    isSetFinished,\n    nameOfPlayer,\n    Player,\n    PlayerNames,\n} from '../../models';\nimport './Summary.css';\n\nexport interface SetSummaryProps extends PlayerNames {\n    className?: string;\n    value: GinSet;\n    onClick?(): void;\n}\n\nexport const SetSummary: FC<SetSummaryProps> = props => {\n    const { value, ...outerProps } = props;\n    // If a player has won the set, don't show loser's points\n    if (isSetFinished(value)) {\n        return (\n            <SetSummaryContainer {...outerProps} finished>\n                <span className=\"c-set-summary--final__winner\">\n                    {nameOfPlayer(props, value.finalResult.winner)} won\n                </span>\n                <span className=\"c-set-summary--final__points\">\n                    {value.finalResult.points}\n                </span>\n            </SetSummaryContainer>\n        );\n    }\n\n    return (\n        <SetSummaryContainer {...outerProps}>\n            <div className=\"c-set-summary__player\">\n                <span className=\"c-set-summary__player-name\">\n                    {props.player1Name}\n                </span>\n                <span className=\"c-set-summary__points\">\n                    {value.currentScores[Player.One]}\n                </span>\n            </div>\n            <div className=\"c-set-summary__player\">\n                <span className=\"c-set-summary__player-name\">\n                    {props.player2Name}\n                </span>\n                <span className=\"c-set-summary__points\">\n                    {value.currentScores[Player.Two]}\n                </span>\n            </div>\n        </SetSummaryContainer>\n    );\n};\n\n/**\n * Outer container element for the set summary.\n */\nconst SetSummaryContainer: FC<\n    Pick<SetSummaryProps, 'className' | 'onClick'> & { finished?: boolean }\n> = ({ className, onClick, finished, children }) => (\n    <div\n        className={classNames(\n            'c-set-summary',\n            finished ? 'c-set-summary--final' : 'c-set-summary--in-progress',\n            className,\n            {\n                'c-set-summary--clickable': Boolean(onClick),\n            },\n        )}\n        onClick={onClick}\n    >\n        {children}\n    </div>\n);\n","import { PureComponent, ReactNode } from 'react';\n\nimport { GinSet, PlayerNames } from '../../models';\nimport { ToggleDrawer } from '../Drawer';\nimport { ScoreColumn } from '../ScoreColumn';\nimport './SetView.css';\nimport { SetSummary } from './Summary';\n\nexport interface SetViewProps extends PlayerNames {\n    value: GinSet;\n}\n\nexport class SetView extends PureComponent<SetViewProps> {\n    public render(): ReactNode {\n        return (\n            <ToggleDrawer\n                activator={({ openDrawer }) => (\n                    <SetSummary\n                        {...this.props}\n                        onClick={openDrawer}\n                        className=\"c-set-view\"\n                    />\n                )}\n            >\n                <ScoreColumn\n                    {...this.props}\n                    className=\"c-set-view__score-column\"\n                />\n            </ToggleDrawer>\n        );\n    }\n}\n","import classNames from 'classnames';\nimport { identity } from 'lodash';\nimport { FC, ReactChild, ReactElement, ReactNode } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Dispatch } from 'redux';\nimport { Action, creators } from 'src/Actions';\n\nimport { Gin, nameOfPlayer, otherPlayer, Player } from 'src/models';\nimport { PerPlayer, Stats } from 'src/models/stats';\nimport {\n    dealerSelector,\n    matchHasStartedSelector,\n    playerNameSelector,\n} from 'src/Reducer';\nimport './StatsViewer.css';\n\ntype StatRowRenderer = <T extends unknown>(\n    title: ReactNode,\n    value: PerPlayer<T>,\n    formatter: (value: T) => ReactChild,\n) => ReactNode;\n\nexport const StatsViewer: FC<{\n    value: Stats;\n    showDealer: boolean;\n    layout: 'grid' | 'stack';\n}> = ({ layout, value, showDealer }) => {\n    const dealer = useSelector(dealerSelector);\n    switch (layout) {\n        case 'stack':\n            return (\n                <StatsStack\n                    value={value}\n                    dealer={showDealer ? dealer : undefined}\n                />\n            );\n        case 'grid':\n            return (\n                <StatsGrid\n                    value={value}\n                    dealer={showDealer ? dealer : undefined}\n                />\n            );\n    }\n};\n\nconst StatsStack: FC<{ value: Stats; dealer: Player | undefined }> = ({\n    value,\n    dealer,\n}) => {\n    const players = useSelector(playerNameSelector);\n    return (\n        <div className=\"c-stats-viewer\">\n            {dealer !== undefined && (\n                <div>Dealer: {nameOfPlayer(players, dealer)}</div>\n            )}\n            {renderStats(\n                (title, v, formatter) => (\n                    <StackRow title={title} value={v} formatter={formatter} />\n                ),\n                value,\n            )}\n        </div>\n    );\n};\n\nconst StackRow = <T extends unknown>(props: {\n    value: PerPlayer<T>;\n    title: ReactNode;\n    formatter(value: T): ReactChild;\n}): ReactElement => {\n    const players = useSelector(playerNameSelector);\n    return (\n        <div className=\"c-share-chart\">\n            <h3>{props.title}</h3>\n            {nameOfPlayer(players, Player.One)}:{' '}\n            {props.formatter(props.value[Player.One])}\n            <br />\n            {nameOfPlayer(players, Player.Two)}:{' '}\n            {props.formatter(props.value[Player.Two])}\n            <br />\n        </div>\n    );\n};\n\nconst formatNumber = (value: number) =>\n    value % 1 === 0 ? value.toString() : value.toFixed(2);\n\nconst formatGinCount = (value: {\n    [Gin.Normal]: number;\n    [Gin.Super]: number;\n}): ReactChild => {\n    const normals = value[Gin.Normal];\n    const supers = value[Gin.Super];\n\n    const normal = <span style={{ whiteSpace: 'nowrap' }}>{normals}</span>;\n    const superSpan = <span style={{ whiteSpace: 'nowrap' }}>{supers}</span>;\n\n    if (normals && supers) {\n        return (\n            <>\n                {normal} <span style={{ opacity: 0.5 }}>|</span> {superSpan}\n            </>\n        );\n    } else if (normals) return normal;\n    else if (supers) return superSpan;\n    else return 0;\n};\n\nconst StatsGrid: FC<{ value: Stats; dealer: Player | undefined }> = ({\n    value,\n    dealer,\n}) => {\n    const players = useSelector(playerNameSelector);\n\n    return (\n        <table className=\"c-stats-viewer c-stats-viewer--grid\">\n            <thead>\n                <tr>\n                    <td className=\"c-stats-viewer--grid__player\">\n                        {nameOfPlayer(players, Player.One)}\n                    </td>\n                    <td>\n                        {dealer !== undefined && (\n                            <DealerToken dealer={dealer} />\n                        )}\n                    </td>\n                    <td className=\"c-stats-viewer--grid__player\">\n                        {nameOfPlayer(players, Player.Two)}\n                    </td>\n                </tr>\n            </thead>\n            <tbody>\n                {renderStats(\n                    (title, v, formatter) => (\n                        <StatsGridRow\n                            title={title}\n                            value={v}\n                            formatter={formatter}\n                        />\n                    ),\n                    value,\n                )}\n            </tbody>\n        </table>\n    );\n};\n\nconst StatsGridRow = <T extends unknown>(props: {\n    value: PerPlayer<T>;\n    title: ReactNode;\n    formatter(value: T): ReactChild;\n}): ReactElement => (\n    <tr>\n        <td>{props.formatter(props.value[Player.One])}</td>\n        <td>{props.title}</td>\n        <td>{props.formatter(props.value[Player.Two])}</td>\n    </tr>\n);\n\nconst renderStats = (row: StatRowRenderer, value: Stats): ReactNode => (\n    <>\n        {row('Wins', value.wins, identity)}\n        {row('Max Streak', value.maxStreak, identity)}\n        {row('Mean PPG', value.meanWinSize, formatNumber)}\n        {row('Biggest Win', value.biggestWin, identity)}\n        {row('Gins', value.ginGames, formatGinCount)}\n    </>\n);\n\n/**\n * Badge for the player who is currently the dealer in the stats grid.\n */\nconst DealerToken: FC<{ dealer: Player }> = ({ dealer }) => {\n    const hasMatchStarted = useSelector(matchHasStartedSelector);\n    const dispatch = useDispatch<Dispatch<Action>>();\n    return (\n        <div\n            className={classNames(\n                'c-dealer-token',\n                dealer === Player.One\n                    ? 'c-dealer-token--p1'\n                    : 'c-dealer-token--p2',\n            )}\n            onClick={\n                hasMatchStarted\n                    ? undefined\n                    : () =>\n                          dispatch(\n                              creators.SetInitialDealer(otherPlayer(dealer)),\n                          )\n            }\n        >\n            <span className=\"c-dealer-token__arrow c-dealer-token__arrow--p1\">\n                <Arrow direction=\"left\" />\n            </span>{' '}\n            Dealer{' '}\n            <span className=\"c-dealer-token__arrow c-dealer-token__arrow--p2\">\n                <Arrow direction=\"right\" />\n            </span>\n        </div>\n    );\n};\n\n/**\n * Platform-agnostic sideways-pointing arrow. , the right-pointing triangle\n * emoji, renders as a stylized play button on mobile operating systems which\n * is undesirable.\n */\nconst Arrow: FC<{ direction: 'left' | 'right' }> = ({ direction }) => (\n    <svg viewBox=\"0 0 5 6\" width={10} height={12}>\n        <path\n            d=\"M 0 0 L 5 3 L 0 6 Z\"\n            style={{\n                fill: 'var(--text-color)',\n            }}\n            transform={direction === 'left' ? 'rotate(180 2.5 3)' : undefined}\n        ></path>\n    </svg>\n);\n","import classNames from 'classnames';\nimport { FC } from 'react';\n\nimport { GinMatchResult, Player, PlayerNames } from 'src/models';\nimport { Button } from '../Button';\nimport './MatchResultViewer.css';\n\nexport const MatchResultViewer: FC<\n    GinMatchResult &\n        PlayerNames & {\n            className?: string;\n            onNewMatch?(): void;\n        }\n> = props => (\n    <div className={classNames('c-match-result-viewer', classNames)}>\n        <div className=\"c-match-result-viewer__winner\">\n            {props.winner === Player.One\n                ? props.player1Name\n                : props.player2Name}{' '}\n            wins!\n        </div>\n        <div className=\"c-match-result-viewer__points\">\n            <span className=\"c-match-result-viewer__points-value\">\n                {props.points}\n            </span>\n            &nbsp;\n            <span className=\"c-match-result-viewer__points-label\">points</span>\n        </div>\n        <div className=\"c-match-result-viewer__actions\">\n            {props.onNewMatch && (\n                <Button onClick={props.onNewMatch}>Play again</Button>\n            )}\n        </div>\n    </div>\n);\n","import classNames from 'classnames';\nimport {\n    FC,\n    forwardRef,\n    useImperativeHandle,\n    useMemo,\n    useRef,\n    useState,\n} from 'react';\nimport MediaQuery from 'react-responsive';\n\nimport { reduceGamesToStats } from 'src/models/stats';\nimport { Game, GinMatch, PlayerNames } from '../../models';\nimport { Drawer, DrawerTitleSpacer } from '../Drawer/Drawer';\nimport { Form } from '../Form';\nimport { GameInput, GameInputProps, PartialGame } from '../GameInput';\nimport { ScoreColumn } from '../ScoreColumn';\nimport { ScrollViewer } from '../ScrollViewer';\nimport { SetView } from '../SetView';\nimport { StatsViewer } from '../StatsViewer';\nimport { Focus } from '../util/Focus';\nimport { MatchResultViewer } from './MatchResultViewer';\nimport './MatchViewer.css';\n\nexport interface MatchViewerProps {\n    players: PlayerNames;\n    value: GinMatch;\n    readOnly?: boolean;\n    onSubmitGame?(game: Game): void;\n    onNewMatch?(): void;\n}\n\nexport const MatchViewer: FC<MatchViewerProps> = ({\n    players,\n    value,\n    readOnly,\n    ...props\n}) => {\n    const gameFormRef = useRef<Focus>(null);\n    const stats = useMemo(() => reduceGamesToStats(value.games), [value.games]);\n    const [drawerOpen, setDrawerOpen] = useState(false);\n\n    const closeGameForm = (): void => {\n        setDrawerOpen(false);\n    };\n\n    const gameForm = (\n        <GameForm\n            ref={gameFormRef}\n            {...players}\n            onSubmitGame={game => {\n                props.onSubmitGame?.(game);\n                closeGameForm();\n            }}\n        />\n    );\n\n    return (\n        <div\n            className={classNames('c-match-viewer', {\n                'c-match-viewer--finished': Boolean(value.finalResult),\n            })}\n        >\n            <MediaQuery minWidth={600}>\n                <ScrollViewer className=\"c-match-viewer__main\">\n                    <div className=\"c-match-viewer__sets\">\n                        {value.sets.map((s, i) => (\n                            <ScoreColumn key={i} {...players} value={s} />\n                        ))}\n                    </div>\n                    <StatsViewer\n                        layout=\"stack\"\n                        value={stats}\n                        showDealer={!value.finalResult}\n                    />\n                </ScrollViewer>\n            </MediaQuery>\n            <MediaQuery maxWidth={600}>\n                <ScrollViewer overflowX=\"hidden\">\n                    {value.sets.map((v, i) => (\n                        <SetView key={i} value={v} {...players} />\n                    ))}\n                    <StatsViewer\n                        layout=\"grid\"\n                        value={stats}\n                        showDealer={!value.finalResult}\n                    />\n                </ScrollViewer>\n            </MediaQuery>\n            {value.finalResult && (\n                <MatchResultViewer\n                    {...players}\n                    {...value.finalResult}\n                    onNewMatch={props.onNewMatch}\n                />\n            )}\n            {!readOnly && (\n                <>\n                    <MediaQuery maxWidth={1000}>\n                        <DrawerTitleSpacer />\n                        <Drawer\n                            open={drawerOpen}\n                            title=\"Add game\"\n                            onTitleClick={() => {\n                                setDrawerOpen(true);\n                                gameFormRef.current?.focus();\n                            }}\n                            onDismiss={closeGameForm}\n                            hideTitle={!!value.finalResult}\n                        >\n                            {gameForm}\n                        </Drawer>\n                    </MediaQuery>\n                    <MediaQuery minWidth={1000}>\n                        <div className=\"c-match-viewer__add-game\">\n                            <h1>Add game</h1>\n                            {gameForm}\n                        </div>\n                    </MediaQuery>\n                </>\n            )}\n        </div>\n    );\n};\n\ntype GameFormProps = Pick<MatchViewerProps, 'onSubmitGame'> &\n    Pick<GameInputProps, 'player1Name' | 'player2Name' | 'disabled'>;\n\nconst GameForm = forwardRef<Focus, GameFormProps>((props, ref) => {\n    const input = useRef<GameInput>(null);\n    const [draft, setDraft] = useState(PartialGame.DEFAULT);\n\n    useImperativeHandle(\n        ref,\n        () => ({\n            focus: () => input.current?.focus(),\n        }),\n        [],\n    );\n\n    return (\n        <Form\n            className=\"c-gameform\"\n            onSubmit={(): void => {\n                // Don't allow submission of incomplete games\n                // TODO show an error in this case\n                if (!Game.guard(draft)) return;\n\n                props.onSubmitGame?.(draft);\n\n                // Wipe the state, so we're ready for the next game input.\n                setDraft(PartialGame.DEFAULT);\n\n                // Move focus back to the top of the form after game entry so that,\n                // if the input form is persistently visible, we're prepared for the\n                // next game.\n                input.current?.focus();\n            }}\n            disableSubmit={props.disabled || !Game.guard(draft)}\n            submitLabel=\"Submit\"\n        >\n            <GameInput\n                ref={input}\n                player1Name={props.player1Name}\n                player2Name={props.player2Name}\n                disabled={props.disabled}\n                value={draft}\n                onChange={v => setDraft(v)}\n            />\n        </Form>\n    );\n});\n","import { connect } from 'react-redux';\nimport { createSelector } from 'reselect';\n\nimport { creators } from '../Actions';\nimport { MatchViewer, MatchViewerProps } from '../components/MatchViewer';\nimport { reduceGamesToMatch } from '../models';\nimport { gameSelector, playerNameSelector } from '../Reducer';\nimport { State } from '../State';\n\nconst matchSelector = createSelector(gameSelector, reduceGamesToMatch);\n\ntype StateProps = Pick<MatchViewerProps, 'value' | 'players'>;\ntype DispatchProps = Pick<MatchViewerProps, 'onSubmitGame' | 'onNewMatch'>;\n\nconst mapStateToProps = (state: State): StateProps => ({\n    value: matchSelector(state),\n    players: playerNameSelector(state),\n});\n\nconst mapDispatchToProps: DispatchProps = {\n    onSubmitGame: creators.FinishGame,\n    onNewMatch: creators.StartNewMatch,\n};\n\nexport const CurrentMatchViewer = connect(\n    mapStateToProps,\n    mapDispatchToProps,\n)(MatchViewer);\n","import { FC } from 'react';\n\nimport { AppHeader } from '../../components/AppHeader';\nimport { CommandBar } from '../../containers/CommandBar';\nimport { CurrentMatchViewer } from '../../containers/CurrentMatchViewer';\n\nimport './Playing.css';\n\nexport const Playing: FC = props => (\n    <div className=\"l-playing\">\n        <AppHeader />\n        <CommandBar />\n        <CurrentMatchViewer />\n    </div>\n);\n","import { Component } from 'react';\nimport { Provider } from 'react-redux';\nimport { applyMiddleware, compose, createStore } from 'redux';\nimport { install } from 'redux-loop';\nimport './App.css';\n\nimport { retrieveState } from './Effects';\nimport { Playing } from './layouts/playing';\nimport { reducer } from './Reducer';\nimport { INITIAL_STATE } from './State';\n\n// XXX figure out why this didn't work.\nconst devtools = () =>\n    (window as any).__REDUX_DEVTOOLS_EXTENSION__ &&\n    (window as any).__REDUX_DEVTOOLS_EXTENSION__();\n\nexport const middleware = compose(applyMiddleware(devtools), install());\n\nconst store = createStore(\n    reducer,\n    retrieveState() || INITIAL_STATE,\n    // Hook enhancer for redux dev-tools\n    install(),\n);\n\nclass App extends Component {\n    public render() {\n        return (\n            <Provider store={store}>\n                <Playing />\n            </Provider>\n        );\n    }\n}\n\nexport default App;\n","// tslint:disable:no-console\n// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the 'N+1' visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n    window.location.hostname === 'localhost' ||\n        // [::1] is the IPv6 localhost address.\n        window.location.hostname === '[::1]' ||\n        // 127.0.0.1/8 is considered localhost for IPv4.\n        window.location.hostname.match(\n            /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n        ),\n);\n\nexport default function register() {\n    if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n        // The URL constructor is available in all browsers that support SW.\n        const publicUrl = new URL(\n            process.env.PUBLIC_URL!,\n            window.location.toString(),\n        );\n        if (publicUrl.origin !== window.location.origin) {\n            // Our service worker won't work if PUBLIC_URL is on a different origin\n            // from what our page is served on. This might happen if a CDN is used to\n            // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n            return;\n        }\n\n        window.addEventListener('load', () => {\n            const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n            if (isLocalhost) {\n                // This is running on localhost. Lets check if a service worker still exists or not.\n                checkValidServiceWorker(swUrl);\n\n                // Add some additional logging to localhost, pointing developers to the\n                // service worker/PWA documentation.\n                navigator.serviceWorker.ready.then(() => {\n                    console.log(\n                        'This web app is being served cache-first by a service ' +\n                            'worker. To learn more, visit https://goo.gl/SC7cgQ',\n                    );\n                });\n            } else {\n                // Is not local host. Just register service worker\n                registerValidSW(swUrl);\n            }\n        });\n    }\n}\n\nfunction registerValidSW(swUrl: string) {\n    navigator.serviceWorker\n        .register(swUrl)\n        .then(registration => {\n            registration.onupdatefound = () => {\n                const installingWorker = registration.installing;\n                if (installingWorker) {\n                    installingWorker.onstatechange = () => {\n                        if (installingWorker.state === 'installed') {\n                            if (navigator.serviceWorker.controller) {\n                                // At this point, the old content will have been purged and\n                                // the fresh content will have been added to the cache.\n                                // It's the perfect time to display a 'New content is\n                                // available; please refresh.' message in your web app.\n                                console.log(\n                                    'New content is available; please refresh.',\n                                );\n                            } else {\n                                // At this point, everything has been precached.\n                                // It's the perfect time to display a\n                                // 'Content is cached for offline use.' message.\n                                console.log(\n                                    'Content is cached for offline use.',\n                                );\n                            }\n                        }\n                    };\n                }\n            };\n        })\n        .catch(error => {\n            console.error('Error during service worker registration:', error);\n        });\n}\n\nfunction checkValidServiceWorker(swUrl: string) {\n    // Check if the service worker can be found. If it can't reload the page.\n    fetch(swUrl)\n        .then(response => {\n            // Ensure service worker exists, and that we really are getting a JS file.\n            if (\n                response.status === 404 ||\n                response.headers.get('content-type')!.indexOf('javascript') ===\n                    -1\n            ) {\n                // No service worker found. Probably a different app. Reload the page.\n                navigator.serviceWorker.ready.then(registration => {\n                    registration.unregister().then(() => {\n                        window.location.reload();\n                    });\n                });\n            } else {\n                // Service worker found. Proceed as normal.\n                registerValidSW(swUrl);\n            }\n        })\n        .catch(() => {\n            console.log(\n                'No internet connection found. App is running in offline mode.',\n            );\n        });\n}\n\nexport function unregister() {\n    if ('serviceWorker' in navigator) {\n        navigator.serviceWorker.ready.then(registration => {\n            registration.unregister();\n        });\n    }\n}\n","import * as ReactDOM from 'react-dom';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\n\nReactDOM.render(<App />, document.getElementById('root') as HTMLElement);\nregisterServiceWorker();\n"],"sourceRoot":""}